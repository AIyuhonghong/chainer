

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Training loop abstraction &mdash; Chainer 2.0.0b1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/modified_theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Chainer 2.0.0b1 documentation" href="../../index.html"/>
        <link rel="up" title="Core functionalities" href="../core.html"/>
        <link rel="next" title="Debug mode" href="debug.html"/>
        <link rel="prev" title="Dataset abstraction" href="dataset.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Chainer
          

          
          </a>

          
            
            
              <div class="version">
                2.0.0b1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Chainer Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Chainer Reference Manual</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../core.html">Core functionalities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="variable.html">Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="flag.html">Flag</a></li>
<li class="toctree-l3"><a class="reference internal" href="function.html">Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="link.html">Link and Chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="optimizer.html">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="serializer.html">Serializer</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataset.html">Dataset abstraction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Training loop abstraction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#trainer">Trainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updater">Updater</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extension">Extension</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trigger">Trigger</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="debug.html">Debug mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">Configuring Chainer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../util.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../check.html">Assertion and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions.html">Standard Function implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../links.html">Standard Link implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimizers.html">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serializers.html">Serializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../function_hooks.html">Function hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initializers.html">Weight Initializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets.html">Dataset examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iterators.html">Iterator examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extensions.html">Trainer extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triggers.html">Trainer triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caffe.html">Caffe Reference Model Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graph.html">Visualization of Computational Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environment.html">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contribution.html">Chainer Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compatibility.html">API Compatibility Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tips.html">Tips and FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../comparison.html">Comparison with Other Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chainer</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Chainer Reference Manual</a> &raquo;</li>
        
          <li><a href="../core.html">Core functionalities</a> &raquo;</li>
        
      <li>Training loop abstraction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/reference/core/training.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-chainer.training"></span><div class="section" id="training-loop-abstraction">
<h1>Training loop abstraction<a class="headerlink" href="#training-loop-abstraction" title="Permalink to this headline">¶</a></h1>
<p>Chainer provides a standard implementation of the training loops under the <a class="reference internal" href="#module-chainer.training" title="chainer.training"><code class="xref py py-mod docutils literal"><span class="pre">chainer.training</span></code></a> module. It is built on top of many other core features of Chainer, including Variable and Function, Link/Chain/ChainList, Optimizer, Dataset, and Reporter/Summary. Compared to the training loop abstraction of other machine learning tool kits, Chainer’s training framework aims at maximal flexibility, while keeps the simplicity for the typical usages. Most components are pluggable, and users can overwrite the definition.</p>
<p>The core of the training loop abstraction is <a class="reference internal" href="#chainer.training.Trainer" title="chainer.training.Trainer"><code class="xref py py-class docutils literal"><span class="pre">Trainer</span></code></a>, which implements the training loop itself. The training loop consists of two parts: one is <a class="reference internal" href="#chainer.training.Updater" title="chainer.training.Updater"><code class="xref py py-class docutils literal"><span class="pre">Updater</span></code></a>, which actually updates the parameters to train, and the other is <a class="reference internal" href="#chainer.training.Extension" title="chainer.training.Extension"><code class="xref py py-class docutils literal"><span class="pre">Extension</span></code></a> for arbitrary functionalities other than the parameter update.</p>
<p>Updater and some extensions use <a class="reference internal" href="dataset.html#module-chainer.dataset" title="chainer.dataset"><code class="xref py py-mod docutils literal"><span class="pre">dataset</span></code></a> and <code class="xref py py-class docutils literal"><span class="pre">Iterator</span></code> to scan the datasets and load mini batches. The trainer also uses <a class="reference internal" href="../util/reporter.html#chainer.Reporter" title="chainer.Reporter"><code class="xref py py-class docutils literal"><span class="pre">Reporter</span></code></a> to collect the observed values, and some extensions use <a class="reference internal" href="../util/reporter.html#chainer.DictSummary" title="chainer.DictSummary"><code class="xref py py-class docutils literal"><span class="pre">DictSummary</span></code></a> to accumulate them and computes the statistics.</p>
<p>You can find many examples for the usage of this training utilities from the official examples. You can also search the extension implementations from <a class="reference internal" href="../extensions.html#extensions"><span class="std std-ref">Trainer extensions</span></a>.</p>
<div class="section" id="trainer">
<h2>Trainer<a class="headerlink" href="#trainer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="chainer.training.Trainer">
<em class="property">class </em><code class="descclassname">chainer.training.</code><code class="descname">Trainer</code><span class="sig-paren">(</span><em>updater</em>, <em>stop_trigger=None</em>, <em>out='result'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/trainer.html#Trainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>The standard training loop in Chainer.</p>
<p>Trainer is an implementation of a training loop. Users can invoke the
training by calling the <a class="reference internal" href="#chainer.training.Trainer.run" title="chainer.training.Trainer.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> method.</p>
<p>Each iteration of the training loop proceeds as follows.</p>
<ul class="simple">
<li>Update of the parameters. It includes the mini-batch loading, forward
and backward computations, and an execution of the update formula.
These are all done by the update object held by the trainer.</li>
<li>Invocation of trainer extensions in the descending order of their
priorities. A trigger object is attached to each extension, and it
decides at each iteration whether the extension should be executed.
Trigger objects are callable objects that take the trainer object as the
argument and return a boolean value indicating whether the extension
should be called or not.</li>
</ul>
<p>Extensions are callable objects that take the trainer object as the
argument. There are three ways to define custom extensions: inheriting the
<a class="reference internal" href="#chainer.training.Extension" title="chainer.training.Extension"><code class="xref py py-class docutils literal"><span class="pre">Extension</span></code></a> class, decorating functions by <a class="reference internal" href="#chainer.training.make_extension" title="chainer.training.make_extension"><code class="xref py py-func docutils literal"><span class="pre">make_extension()</span></code></a>,
and defining any callable including lambda functions. See
<a class="reference internal" href="#chainer.training.Extension" title="chainer.training.Extension"><code class="xref py py-class docutils literal"><span class="pre">Extension</span></code></a> for more details on custom extensions and how to
configure them.</p>
<p>Users can register extensions to the trainer by calling the <a class="reference internal" href="#chainer.training.Trainer.extend" title="chainer.training.Trainer.extend"><code class="xref py py-meth docutils literal"><span class="pre">extend()</span></code></a>
method, where some configurations can be added.</p>
<ul class="simple">
<li>Trigger object, which is also explained above. In most cases,
<code class="xref py py-class docutils literal"><span class="pre">IntervalTrigger</span></code> is used, in which case users can simply specify
a tuple of the interval length and its unit, like
<code class="docutils literal"><span class="pre">(1000,</span> <span class="pre">'iteration')</span></code> or <code class="docutils literal"><span class="pre">(1,</span> <span class="pre">'epoch')</span></code>.</li>
<li>The order of execution of extensions is determined by their priorities.
Extensions of higher priorities are invoked earlier. There are three
standard values for the priorities:<ul>
<li><code class="docutils literal"><span class="pre">PRIORITY_WRITER</span></code>. This is the priority for extensions that write
some records to the <code class="xref py py-attr docutils literal"><span class="pre">observation</span></code> dictionary. It includes cases
that the extension directly adds values to the observation dictionary,
or the extension uses the <a class="reference internal" href="../util/reporter.html#chainer.report" title="chainer.report"><code class="xref py py-func docutils literal"><span class="pre">chainer.report()</span></code></a> function to report
values to the observation dictionary.</li>
<li><code class="docutils literal"><span class="pre">PRIORITY_EDITOR</span></code>. This is the priority for extensions that edit the
<code class="xref py py-attr docutils literal"><span class="pre">observation</span></code> dictionary based on already reported values.</li>
<li><code class="docutils literal"><span class="pre">PRIORITY_READER</span></code>. This is the priority for extensions that only read
records from the <code class="xref py py-attr docutils literal"><span class="pre">observation</span></code> dictionary. This is also suitable
for extensions that do not use the <code class="xref py py-attr docutils literal"><span class="pre">observation</span></code> dictionary at
all.</li>
</ul>
</li>
<li>Extensions with <code class="docutils literal"><span class="pre">invoke_before_training</span></code> flag on are also invoked at
the beginning of the training loop. Extensions that update the training
status (e.g., changing learning rates) should have this flag to be
<code class="docutils literal"><span class="pre">True</span></code> to ensure that resume of the training loop correctly recovers
the training status.</li>
</ul>
<p>The current state of the trainer object and objects handled by the trainer
can be serialized through the standard serialization protocol of Chainer.
It enables us to easily suspend and resume the training loop.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The serialization does not recover everything of the training loop. It
only recovers the states which change over the training (e.g.
parameters, optimizer states, the batch iterator state, extension
states, etc.). You must initialize the objects correctly before
deserializing the states.</p>
<p class="last">On the other hand, it means that users can change the settings on
deserialization. For example, the exit condition can be changed on the
deserialization, so users can train the model for some iterations,
suspend it, and then resume it with larger number of total iterations.</p>
</div>
<p>During the training, it also creates a <a class="reference internal" href="../util/reporter.html#chainer.Reporter" title="chainer.Reporter"><code class="xref py py-class docutils literal"><span class="pre">Reporter</span></code></a> object to
store observed values on each update. For each iteration, it creates a
fresh observation dictionary and stores it in the <code class="xref py py-attr docutils literal"><span class="pre">observation</span></code>
attribute.</p>
<p>Links of the target model of each optimizer are registered to the reporter
object as observers, where the name of each observer is constructed as the
format <code class="docutils literal"><span class="pre">&lt;optimizer</span> <span class="pre">name&gt;&lt;link</span> <span class="pre">name&gt;</span></code>. The link name is given by the
<code class="xref py py-meth docutils literal"><span class="pre">chainer.Link.namedlink()</span></code> method, which represents the path to each
link in the hierarchy. Other observers can be registered by accessing the
reporter object via the <code class="xref py py-attr docutils literal"><span class="pre">reporter</span></code> attribute.</p>
<p>The default trainer is <cite>plain</cite>, i.e., it does not contain any extensions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>updater</strong> (<a class="reference internal" href="#chainer.training.Updater" title="chainer.training.Updater"><em>Updater</em></a>) – Updater object. It defines how to
update the models.</li>
<li><strong>stop_trigger</strong> – Trigger that determines when to stop the training loop.
If it is not callable, it is passed to <code class="xref py py-class docutils literal"><span class="pre">IntervalTrigger</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>updater</strong> – The updater object for this trainer.</li>
<li><strong>stop_trigger</strong> – Trigger that determines when to stop the training loop.
The training loop stops at the iteration on which this trigger
returns <code class="docutils literal"><span class="pre">True</span></code>.</li>
<li><strong>observation</strong> – Observation of values made at the last update. See the
<code class="xref py py-class docutils literal"><span class="pre">Reporter</span></code> class for details.</li>
<li><strong>out</strong> – Output directory.</li>
<li><strong>reporter</strong> – Reporter object to report observed values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="chainer.training.Trainer.elapsed_time">
<code class="descname">elapsed_time</code><a class="headerlink" href="#chainer.training.Trainer.elapsed_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Total time used for the training.</p>
<p>The time is in seconds. If the training is resumed from snapshot, it
includes the time of all the previous training to get the current
state of the trainer.</p>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Trainer.extend">
<code class="descname">extend</code><span class="sig-paren">(</span><em>extension</em>, <em>name=None</em>, <em>trigger=None</em>, <em>priority=None</em>, <em>invoke_before_training=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/trainer.html#Trainer.extend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Trainer.extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers an extension to the trainer.</p>
<p><a class="reference internal" href="#chainer.training.Extension" title="chainer.training.Extension"><code class="xref py py-class docutils literal"><span class="pre">Extension</span></code></a> is a callable object which is called after each
update unless the corresponding trigger object decides to skip the
iteration. The order of execution is determined by priorities:
extensions with higher priorities are called earlier in each iteration.
Extensions with the same priority are invoked in the order of
registrations.</p>
<p>If two or more extensions with the same name are registered, suffixes
are added to the names of the second to last extensions. The suffix is
<code class="docutils literal"><span class="pre">_N</span></code> where N is the ordinal of the extensions.</p>
<p>See <a class="reference internal" href="#chainer.training.Extension" title="chainer.training.Extension"><code class="xref py py-class docutils literal"><span class="pre">Extension</span></code></a> for the interface of extensions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>extension</strong> – Extension to register.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Name of the extension. If it is omitted, the
<code class="docutils literal"><span class="pre">default_name</span></code> attribute of the extension is used instead.
Note that the name would be suffixed by an ordinal in case of
duplicated names as explained above.</li>
<li><strong>trigger</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)"><em>tuple</em></a><em> or </em><em>Trigger</em>) – Trigger object that determines when to
invoke the extension. If it is <code class="docutils literal"><span class="pre">None</span></code>, <code class="docutils literal"><span class="pre">extension.trigger</span></code>
is used instead. If it is <code class="docutils literal"><span class="pre">None</span></code> and the extension does not
have the trigger attribute, the extension is triggered at every
iteration by default. If the trigger is not callable, it is
passed to <code class="xref py py-class docutils literal"><span class="pre">IntervalTrigger</span></code> to build an interval
trigger.</li>
<li><strong>priority</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Invocation priority of the extension. Extensions
are invoked in the descending order of priorities in each
iteration. If this is <code class="docutils literal"><span class="pre">None</span></code>, <code class="docutils literal"><span class="pre">extension.priority</span></code> is used
instead.</li>
<li><strong>invoke_before_training</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.6)"><em>None</em></a>) – If <code class="docutils literal"><span class="pre">True</span></code>, the extension
is also invoked just before entering the training loop. If this
is <code class="docutils literal"><span class="pre">None</span></code>, <code class="docutils literal"><span class="pre">extension.invoke_before_training</span></code> is used
instead. This option is mainly used for extensions that alter
the training configuration (e.g., learning rates); in such a
case, resuming from snapshots require the call of extension to
recover the configuration before any updates.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Trainer.get_extension">
<code class="descname">get_extension</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/trainer.html#Trainer.get_extension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Trainer.get_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the extension of a given name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Name of the extension.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Extension.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Trainer.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/trainer.html#Trainer.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Trainer.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the training loop.</p>
<p>This method is the core of <code class="docutils literal"><span class="pre">Trainer</span></code>. It executes the whole loop of
training the models.</p>
<p>Note that this method cannot run multiple times for one trainer object.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="updater">
<h2>Updater<a class="headerlink" href="#updater" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="chainer.training.Updater">
<em class="property">class </em><code class="descclassname">chainer.training.</code><code class="descname">Updater</code><a class="reference internal" href="../../_modules/chainer/training/updater.html#Updater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Updater" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface of updater objects for trainers.</p>
<p>TODO(beam2d): document it.</p>
<dl class="method">
<dt id="chainer.training.Updater.connect_trainer">
<code class="descname">connect_trainer</code><span class="sig-paren">(</span><em>trainer</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#Updater.connect_trainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Updater.connect_trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects the updater to the trainer that will call it.</p>
<p>The typical usage of this method is to register additional links to the
reporter of the trainer. This method is called at the end of the
initialization of <a class="reference internal" href="#chainer.training.Trainer" title="chainer.training.Trainer"><code class="xref py py-class docutils literal"><span class="pre">Trainer</span></code></a>. The default
implementation does nothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trainer</strong> (<a class="reference internal" href="#chainer.training.Trainer" title="chainer.training.Trainer"><em>Trainer</em></a>) – Trainer object to which the
updater is registered.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Updater.finalize">
<code class="descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#Updater.finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Updater.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalizes the updater object.</p>
<p>This method is called at the end of training loops. It should finalize
each dataset iterator used in this updater.</p>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Updater.get_all_optimizers">
<code class="descname">get_all_optimizers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#Updater.get_all_optimizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Updater.get_all_optimizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a dictionary of all optimizers for this updater.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary that maps names to optimizers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Updater.get_optimizer">
<code class="descname">get_optimizer</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#Updater.get_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Updater.get_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the optimizer of given name.</p>
<p>Updater holds one or more optimizers with names. They can be retrieved
by this method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Name of the optimizer.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Optimizer of the name.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="optimizer.html#chainer.Optimizer" title="chainer.Optimizer">Optimizer</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Updater.serialize">
<code class="descname">serialize</code><span class="sig-paren">(</span><em>serializer</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#Updater.serialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Updater.serialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Serializes the current state of the updater object.</p>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Updater.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#Updater.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Updater.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the parameters of the target model.</p>
<p>This method implements an update formula for the training task,
including data loading, forward/backward computations, and actual
updates of parameters.</p>
<p>This method is called once at each iteration of the training loop.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chainer.training.StandardUpdater">
<em class="property">class </em><code class="descclassname">chainer.training.</code><code class="descname">StandardUpdater</code><span class="sig-paren">(</span><em>iterator</em>, <em>optimizer</em>, <em>converter=&lt;function concat_examples&gt;</em>, <em>device=None</em>, <em>loss_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#StandardUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.StandardUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard implementation of Updater.</p>
<p>This is the standard implementation of <a class="reference internal" href="#chainer.training.Updater" title="chainer.training.Updater"><code class="xref py py-class docutils literal"><span class="pre">Updater</span></code></a>. It accepts one or
more training datasets and one or more optimizers. The default update
routine assumes that there is only one training dataset and one optimizer.
Users can override this update routine by inheriting this class and
overriding the <code class="xref py py-meth docutils literal"><span class="pre">update_core()</span></code> method. Each batch is converted to input
arrays by <code class="xref py py-func docutils literal"><span class="pre">concat_examples()</span></code> by default, which can
also be manually set by <code class="docutils literal"><span class="pre">converter</span></code> argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterator</strong> – Dataset iterator for the training dataset. It can also be a
dictionary of iterators. If this is just an iterator, then the
iterator is registered by the name <code class="docutils literal"><span class="pre">'main'</span></code>.</li>
<li><strong>optimizer</strong> – Optimizer to update parameters. It can also be a dictionary
of optimizers. If this is just an optimizer, then the optimizer is
registered by the name <code class="docutils literal"><span class="pre">'main'</span></code>.</li>
<li><strong>converter</strong> – Converter function to build input arrays. Each batch
extracted by the main iterator and the <code class="docutils literal"><span class="pre">device</span></code> option are passed
to this function. <a class="reference internal" href="dataset.html#chainer.dataset.concat_examples" title="chainer.dataset.concat_examples"><code class="xref py py-func docutils literal"><span class="pre">concat_examples()</span></code></a> is used
by default.</li>
<li><strong>device</strong> – Device to which the training data is sent. Negative value
indicates the host memory (CPU).</li>
<li><strong>loss_func</strong> – Loss function. The target link of the main optimizer is used
by default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>converter</strong> – Converter function.</li>
<li><strong>loss_func</strong> – Loss function. If it is <code class="docutils literal"><span class="pre">None</span></code>, the target link of the
main optimizer is used instead.</li>
<li><strong>device</strong> – Device to which the training data is sent.</li>
<li><strong>iteration</strong> – Current number of completed updates.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chainer.training.StandardUpdater.get_iterator">
<code class="descname">get_iterator</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#StandardUpdater.get_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.StandardUpdater.get_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the dataset iterator of given name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Name of the dataset iterator.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Corresponding dataset iterator.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="dataset.html#chainer.dataset.Iterator" title="chainer.dataset.Iterator">Iterator</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chainer.training.ParallelUpdater">
<em class="property">class </em><code class="descclassname">chainer.training.</code><code class="descname">ParallelUpdater</code><span class="sig-paren">(</span><em>iterator</em>, <em>optimizer</em>, <em>converter=&lt;function concat_examples&gt;</em>, <em>models=None</em>, <em>devices=None</em>, <em>loss_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/updater.html#ParallelUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.ParallelUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of a parallel GPU Updater.</p>
<p>This is an implementation of <a class="reference internal" href="#chainer.training.Updater" title="chainer.training.Updater"><code class="xref py py-class docutils literal"><span class="pre">Updater</span></code></a> that uses multiple GPUs.
It behaves similarly to <a class="reference internal" href="#chainer.training.StandardUpdater" title="chainer.training.StandardUpdater"><code class="xref py py-class docutils literal"><span class="pre">StandardUpdater</span></code></a>. The
update routine is modified to support data-parallel computation on multiple
GPUs in one machine. It is based on synchronous parallel SGD: it
parallelizes the gradient computation over a mini-batch, and updates the
parameters only in the main device.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iterator</strong> – Dataset iterator for the training dataset. It can also be a
dictionary of iterators. If this is just an iterator, then the
iterator is registered by the name <code class="docutils literal"><span class="pre">'main'</span></code>.</li>
<li><strong>optimizer</strong> – Optimizer to update parameters. It can also be a dictionary
of optimizers. If this is just an optimizer, then the optimizer is
registered by the name <code class="docutils literal"><span class="pre">'main'</span></code>.</li>
<li><strong>converter</strong> – Converter function to build input arrays. Each batch
extracted by the main iterator is split equally between the
devices and then passed with corresponding <code class="docutils literal"><span class="pre">device</span></code> option to
this function. <a class="reference internal" href="dataset.html#chainer.dataset.concat_examples" title="chainer.dataset.concat_examples"><code class="xref py py-func docutils literal"><span class="pre">concat_examples()</span></code></a> is used by
default.</li>
<li><strong>models</strong> – Dictionary of models. The main model should be the same model
attached to the <code class="docutils literal"><span class="pre">'main'</span></code> optimizer.</li>
<li><strong>devices</strong> – Dictionary of devices to which the training data is sent. The
devices should be arranged in a dictionary with the same structure
as <code class="docutils literal"><span class="pre">models</span></code>.</li>
<li><strong>loss_func</strong> – Loss function. The model is used as a loss function by
default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="extension">
<h2>Extension<a class="headerlink" href="#extension" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="chainer.training.Extension">
<em class="property">class </em><code class="descclassname">chainer.training.</code><code class="descname">Extension</code><a class="reference internal" href="../../_modules/chainer/training/extension.html#Extension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class of trainer extensions.</p>
<p>Extension of <a class="reference internal" href="#chainer.training.Trainer" title="chainer.training.Trainer"><code class="xref py py-class docutils literal"><span class="pre">Trainer</span></code></a> is a callable object that takes the trainer
object as the argument. It also provides some default configurations as its
attributes, e.g. the default trigger and the default priority. This class
provides a set of typical default values for these attributes.</p>
<p>There are three ways to define users’ own extensions: inheriting this
class, decorating closures by <a class="reference internal" href="#chainer.training.make_extension" title="chainer.training.make_extension"><code class="xref py py-func docutils literal"><span class="pre">make_extension()</span></code></a>, or using any callable
including lambda functions as extensions. Decorator can slightly reduce the
overhead and is much easier to use, while this class provides more
flexibility (for example, it can have methods to configure the behavior).
Using a lambda function allows one-line coding for simple purposes, but
users have to specify the configurations as arguments to
<a class="reference internal" href="#chainer.training.Trainer.extend" title="chainer.training.Trainer.extend"><code class="xref py py-meth docutils literal"><span class="pre">Trainer.extend()</span></code></a>. For a callable not inheriting this class, the
default configurations of this class are used unless the user explicitly
specifies them in <a class="reference internal" href="#chainer.training.Trainer.extend" title="chainer.training.Trainer.extend"><code class="xref py py-meth docutils literal"><span class="pre">Trainer.extend()</span></code></a> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>trigger</strong> – Default value of trigger for this extension. It is set to
<code class="docutils literal"><span class="pre">(1,</span> <span class="pre">'iteration')</span></code> by default.</li>
<li><strong>priority</strong> – Default priority of the extension. It is set to
<code class="docutils literal"><span class="pre">PRIORITY_READER</span></code> by default.</li>
<li><strong>invoke_before_training</strong> – Default flag to decide whether this extension
should be invoked before the training starts. The default value is
<code class="docutils literal"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="chainer.training.Extension.default_name">
<code class="descname">default_name</code><a class="headerlink" href="#chainer.training.Extension.default_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Default name of the extension.</p>
<p>It is the name of the class by default. Implementation can override
this property, or provide a class attribute to hide it.</p>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Extension.finalize">
<code class="descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/extension.html#Extension.finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Extension.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalizes the extension.</p>
<p>This method is called at the end of the training loop.</p>
</dd></dl>

<dl class="method">
<dt id="chainer.training.Extension.serialize">
<code class="descname">serialize</code><span class="sig-paren">(</span><em>serializer</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/extension.html#Extension.serialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.Extension.serialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Serializes the extension state.</p>
<p>It is called when a trainer that owns this extension is serialized. It
serializes nothing by default.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="chainer.training.make_extension">
<code class="descclassname">chainer.training.</code><code class="descname">make_extension</code><span class="sig-paren">(</span><em>trigger=None</em>, <em>default_name=None</em>, <em>priority=None</em>, <em>invoke_before_training=False</em>, <em>finalizer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/extension.html#make_extension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.make_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to make given functions into trainer extensions.</p>
<p>This decorator just adds some attributes to a given function. The value of
the attributes are given by the arguments of this decorator.</p>
<p>See <a class="reference internal" href="#chainer.training.Extension" title="chainer.training.Extension"><code class="xref py py-class docutils literal"><span class="pre">Extension</span></code></a> for details of trainer extensions. Most of the
default values of arguments also follow those for this class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trigger</strong> – Default trigger of the extension.</li>
<li><strong>default_name</strong> – Default name of the extension. The name of a given
function is used by default.</li>
<li><strong>priority</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Default priority of the extension.</li>
<li><strong>invoke_before_training</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Default flag to decide whether the
extension should be invoked before any training.</li>
<li><strong>finalizer</strong> – Finalizer function of this extension. The finalizer is
called at the end of the training loop.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="trigger">
<h2>Trigger<a class="headerlink" href="#trigger" title="Permalink to this headline">¶</a></h2>
<p>Trigger is a callable object to decide when to process some specific event within the training loop. It takes a Trainer object as the argument, and returns True if some event should be fired.</p>
<p>It is mainly used to determine when to call an extension. It is also used to determine when to quit the training loop.</p>
<dl class="function">
<dt id="chainer.training.get_trigger">
<code class="descclassname">chainer.training.</code><code class="descname">get_trigger</code><span class="sig-paren">(</span><em>trigger</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/training/util.html#get_trigger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.training.get_trigger" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a trigger object.</p>
<p>Trigger object is a callable that accepts a
<a class="reference internal" href="#chainer.training.Trainer" title="chainer.training.Trainer"><code class="xref py py-class docutils literal"><span class="pre">Trainer</span></code></a> object as an argument and returns a
boolean value. When it returns True, various kinds of events can occur
depending on the context in which the trigger is used. For example, if the
trigger is passed to the <a class="reference internal" href="#chainer.training.Trainer" title="chainer.training.Trainer"><code class="xref py py-class docutils literal"><span class="pre">Trainer</span></code></a> as the <cite>stop
trigger</cite>, the training loop breaks when the trigger returns True. If the
trigger is passed to the <a class="reference internal" href="#chainer.training.Trainer.extend" title="chainer.training.Trainer.extend"><code class="xref py py-meth docutils literal"><span class="pre">extend()</span></code></a> method of
a trainer, then the registered extension is invoked only when the trigger
returns True.</p>
<p>This function returns a trigger object based on the argument.
If <code class="docutils literal"><span class="pre">trigger</span></code> is already a callable, it just returns the trigger. If
<code class="docutils literal"><span class="pre">trigger</span></code> is <code class="docutils literal"><span class="pre">None</span></code>, it returns a trigger that never fires. Otherwise,
it passes the value to <a class="reference internal" href="../triggers.html#chainer.training.triggers.IntervalTrigger" title="chainer.training.triggers.IntervalTrigger"><code class="xref py py-class docutils literal"><span class="pre">IntervalTrigger</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trigger</strong> – Trigger object. It can be either an already built trigger
object (i.e., a callable object that accepts a trainer object and
returns a bool value), or a tuple. In latter case, the tuple is
passed to <a class="reference internal" href="../triggers.html#chainer.training.triggers.IntervalTrigger" title="chainer.training.triggers.IntervalTrigger"><code class="xref py py-class docutils literal"><span class="pre">IntervalTrigger</span></code></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">trigger</span></code> if it is a callable, otherwise a
<a class="reference internal" href="../triggers.html#chainer.training.triggers.IntervalTrigger" title="chainer.training.triggers.IntervalTrigger"><code class="xref py py-class docutils literal"><span class="pre">IntervalTrigger</span></code></a>
object made from <code class="docutils literal"><span class="pre">trigger</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="debug.html" class="btn btn-neutral float-right" title="Debug mode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dataset.html" class="btn btn-neutral" title="Dataset abstraction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Preferred Networks, inc. and Preferred Infrastructure, inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.0.0b1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>