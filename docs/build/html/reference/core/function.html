

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Function &mdash; Chainer 2.0.0b1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/modified_theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Chainer 2.0.0b1 documentation" href="../../index.html"/>
        <link rel="up" title="Core functionalities" href="../core.html"/>
        <link rel="next" title="Link and Chain" href="link.html"/>
        <link rel="prev" title="Flag" href="flag.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Chainer
          

          
          </a>

          
            
            
              <div class="version">
                2.0.0b1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Chainer Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Chainer Reference Manual</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../core.html">Core functionalities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="variable.html">Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="flag.html">Flag</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="link.html">Link and Chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="optimizer.html">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="serializer.html">Serializer</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataset.html">Dataset abstraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="training.html">Training loop abstraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="debug.html">Debug mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html">Configuring Chainer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../util.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../check.html">Assertion and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions.html">Standard Function implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../links.html">Standard Link implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimizers.html">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serializers.html">Serializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../function_hooks.html">Function hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initializers.html">Weight Initializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets.html">Dataset examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iterators.html">Iterator examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extensions.html">Trainer extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triggers.html">Trainer triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caffe.html">Caffe Reference Model Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graph.html">Visualization of Computational Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environment.html">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contribution.html">Chainer Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compatibility.html">API Compatibility Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tips.html">Tips and FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../comparison.html">Comparison with Other Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chainer</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Chainer Reference Manual</a> &raquo;</li>
        
          <li><a href="../core.html">Core functionalities</a> &raquo;</li>
        
      <li>Function</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/reference/core/function.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="function">
<h1>Function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="chainer.Function">
<em class="property">class </em><code class="descclassname">chainer.</code><code class="descname">Function</code><a class="reference internal" href="../../_modules/chainer/function.html#Function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Function on variables with backpropagation ability.</p>
<p>All function implementations defined in <a class="reference internal" href="../functions.html#module-chainer.functions" title="chainer.functions"><code class="xref py py-mod docutils literal"><span class="pre">chainer.functions</span></code></a> inherit
this class.</p>
<p>The main feature of this class is keeping track of function applications as
a backward graph. When a function is applied to <a class="reference internal" href="variable.html#chainer.Variable" title="chainer.Variable"><code class="xref py py-class docutils literal"><span class="pre">Variable</span></code></a> objects,
its <a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a> method is called on <code class="xref py py-data docutils literal"><span class="pre">data</span></code> fields of
input variables, and at the same time it chains references from output
variable nodes to the function and from the function to its input nodes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As of v2.0, the input/output variables and their corresponding variable
nodes in the graph are distinguished. Function acts like a function on
<a class="reference internal" href="variable.html#chainer.Variable" title="chainer.Variable"><code class="xref py py-class docutils literal"><span class="pre">Variable</span></code></a> objects that returns <a class="reference internal" href="variable.html#chainer.Variable" title="chainer.Variable"><code class="xref py py-class docutils literal"><span class="pre">Variable</span></code></a> objects as
outputs, whereas these objects do not appear directly in the graph.
Instead, their corresponding <code class="xref py py-class docutils literal"><span class="pre">VariableNode</span></code> objects are inserted
to the graph.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>As of v1.5, a function instance cannot be used twice in any
computational graphs. In order to reuse a function object multiple
times, use <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.copy" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">copy.copy()</span></code></a> before the function applications to make a
copy of the instance.</p>
<p class="last">This restriction also means that we cannot make a <em>stateful function</em>
anymore. For example, it is now not allowed to let a function hold
parameters. Define a function as a pure (stateless) procedure, and use
<a class="reference internal" href="link.html#chainer.Link" title="chainer.Link"><code class="xref py py-class docutils literal"><span class="pre">Link</span></code></a> to combine it with parameter variables.</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p>Let <code class="docutils literal"><span class="pre">x</span></code> an instance of <a class="reference internal" href="variable.html#chainer.Variable" title="chainer.Variable"><code class="xref py py-class docutils literal"><span class="pre">Variable</span></code></a> and <code class="docutils literal"><span class="pre">f</span></code> an instance of
<a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> taking only one argument. Then a line</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">chainer</span><span class="o">,</span> <span class="nn">chainer.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>computes a new variable <code class="docutils literal"><span class="pre">y</span></code> and creates backward references. Actually,
backward references are set as per the following diagram:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">node</span> <span class="o">&lt;---</span> <span class="n">f</span> <span class="o">&lt;---</span> <span class="n">y</span><span class="o">.</span><span class="n">node</span>
</pre></div>
</div>
<p>If an application of another function <code class="docutils literal"><span class="pre">g</span></code> occurs as</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>then the graph grows with a branch:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>         <span class="o">|---</span> <span class="n">f</span> <span class="o">&lt;---</span> <span class="n">y</span><span class="o">.</span><span class="n">node</span>
<span class="n">x</span><span class="o">.</span><span class="n">node</span> <span class="o">&lt;-+</span>
         <span class="o">|---</span> <span class="n">g</span> <span class="o">&lt;---</span> <span class="n">z</span><span class="o">.</span><span class="n">node</span>
</pre></div>
</div>
<p class="last">Note that the branching is correctly managed on backward computation,
i.e. the gradients from <code class="docutils literal"><span class="pre">f</span></code> and <code class="docutils literal"><span class="pre">g</span></code> are accumulated to the gradient
of <code class="docutils literal"><span class="pre">x</span></code>.</p>
</div>
<p>Every function implementation should provide <a class="reference internal" href="#chainer.Function.forward_cpu" title="chainer.Function.forward_cpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_cpu()</span></code></a>,
<a class="reference internal" href="#chainer.Function.forward_gpu" title="chainer.Function.forward_gpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_gpu()</span></code></a>, <a class="reference internal" href="#chainer.Function.backward_cpu" title="chainer.Function.backward_cpu"><code class="xref py py-meth docutils literal"><span class="pre">backward_cpu()</span></code></a> and <a class="reference internal" href="#chainer.Function.backward_gpu" title="chainer.Function.backward_gpu"><code class="xref py py-meth docutils literal"><span class="pre">backward_gpu()</span></code></a>.
Alternatively, one can provide <a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a> and <a class="reference internal" href="#chainer.Function.backward" title="chainer.Function.backward"><code class="xref py py-meth docutils literal"><span class="pre">backward()</span></code></a> instead
of separate methods. Backward methods have default implementations that
just return <code class="docutils literal"><span class="pre">None</span></code>, which indicates that the function is non-
differentiable.</p>
<p>For functions that do not need a part of inputs in backward computation,
there is a way to possibly reduce the memory consumption by quickly
releasing the input arrays after the forward propagation. This is done by
calling <a class="reference internal" href="#chainer.Function.retain_inputs" title="chainer.Function.retain_inputs"><code class="xref py py-meth docutils literal"><span class="pre">retain_inputs()</span></code></a> from inside of <a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a> (including
<a class="reference internal" href="#chainer.Function.forward_cpu" title="chainer.Function.forward_cpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_cpu()</span></code></a> and <a class="reference internal" href="#chainer.Function.forward_gpu" title="chainer.Function.forward_gpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_gpu()</span></code></a>). See the documentation of
<a class="reference internal" href="#chainer.Function.retain_inputs" title="chainer.Function.retain_inputs"><code class="xref py py-meth docutils literal"><span class="pre">retain_inputs()</span></code></a> for details.</p>
<p>For functions that need a part of outputs in backward computation, it is
<strong>strongly recommended</strong> to call <a class="reference internal" href="#chainer.Function.retain_outputs" title="chainer.Function.retain_outputs"><code class="xref py py-meth docutils literal"><span class="pre">retain_outputs()</span></code></a> from inside of
<a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a> (including <a class="reference internal" href="#chainer.Function.forward_cpu" title="chainer.Function.forward_cpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_cpu()</span></code></a> and <a class="reference internal" href="#chainer.Function.forward_gpu" title="chainer.Function.forward_gpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_gpu()</span></code></a>).
It marks the specified output variable nodes to retain the data. The
retained data can be accessed by <code class="xref py py-attr docutils literal"><span class="pre">output_arrays</span></code> property.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>inputs</strong> – A tuple or list of input variables.</li>
<li><strong>outputs</strong> – A tuple or list of output variables.</li>
<li><strong>output_data</strong> – A tuple of retained output arrays. It has the same length
as <code class="xref py py-attr docutils literal"><span class="pre">outputs</span></code>. The data of variables that are not retained are
set to <code class="docutils literal"><span class="pre">None</span></code>. See <a class="reference internal" href="#chainer.Function.retain_outputs" title="chainer.Function.retain_outputs"><code class="xref py py-meth docutils literal"><span class="pre">retain_outputs()</span></code></a> for details.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chainer.Function.add_hook">
<code class="descname">add_hook</code><span class="sig-paren">(</span><em>hook</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.add_hook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.add_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers the function hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hook</strong> (<a class="reference internal" href="../function_hooks.html#chainer.function.FunctionHook" title="chainer.function.FunctionHook"><em>FunctionHook</em></a>) – Function hook to be registered.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – Name of the function hook.
name must be unique among function hooks
registered to the function. If <code class="docutils literal"><span class="pre">None</span></code>,
default name of the function hook is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.backward">
<code class="descname">backward</code><span class="sig-paren">(</span><em>inputs</em>, <em>grad_outputs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.backward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies backprop to output gradient arrays.</p>
<p>It delegates the procedure to <a class="reference internal" href="#chainer.Function.backward_cpu" title="chainer.Function.backward_cpu"><code class="xref py py-meth docutils literal"><span class="pre">backward_cpu()</span></code></a> or
<a class="reference internal" href="#chainer.Function.backward_gpu" title="chainer.Function.backward_gpu"><code class="xref py py-meth docutils literal"><span class="pre">backward_gpu()</span></code></a> by default. Which it selects is determined by the
type of input arrays and output gradient arrays. Implementations of
<a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must implement either CPU/GPU methods or this method,
if the function is intended to be backprop-ed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – Tuple of input arrays.</li>
<li><strong>grad_outputs</strong> – Tuple of output gradient arrays.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Tuple of input gradient arrays. Some or all of them can be
<code class="docutils literal"><span class="pre">None</span></code>, if the function is not differentiable on
inputs.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementations of <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must take care that the
return value must be a tuple even if it returns only one array.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.backward_cpu">
<code class="descname">backward_cpu</code><span class="sig-paren">(</span><em>inputs</em>, <em>grad_outputs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.backward_cpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.backward_cpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies backprop to output gradient arrays on CPU.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – Tuple of input <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> object(s).</li>
<li><strong>grad_outputs</strong> – Tuple of output gradient <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a>
object(s).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Tuple of input gradient <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> object(s).
Some or all of them can be <code class="docutils literal"><span class="pre">None</span></code>, if the function is not
differentiable on corresponding inputs.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementations of <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must take care that the
return value must be a tuple even if it returns only one array.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.backward_cpu_cosim">
<code class="descname">backward_cpu_cosim</code><span class="sig-paren">(</span><em>inputs</em>, <em>grad_outputs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.backward_cpu_cosim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.backward_cpu_cosim" title="Permalink to this definition">¶</a></dt>
<dd><p>backward cosim between numpy and MKLDNN</p>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.backward_gpu">
<code class="descname">backward_gpu</code><span class="sig-paren">(</span><em>inputs</em>, <em>grad_outputs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.backward_gpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.backward_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies backprop to output gradient arrays on GPU.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – Tuple of input <code class="xref py py-class docutils literal"><span class="pre">cupy.ndarray</span></code>
object(s).</li>
<li><strong>grad_outputs</strong> – Tuple of output gradient
<code class="xref py py-class docutils literal"><span class="pre">cupy.ndarray</span></code> object(s).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Tuple of input gradient <code class="xref py py-class docutils literal"><span class="pre">cupy.ndarray</span></code>
object(s). Some or all of them can be <code class="docutils literal"><span class="pre">None</span></code>, if the function is
not differentiable on corresponding inputs.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementations of <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must take care that the
return value must be a tuple even if it returns only one array.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.check_type_forward">
<code class="descname">check_type_forward</code><span class="sig-paren">(</span><em>in_types</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.check_type_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.check_type_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks types of input data before forward propagation.</p>
<p>Before <a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a> is called, this function is called.
You need to validate types of input data in this function
using <a class="reference internal" href="../check.html#type-check-utils"><span class="std std-ref">the type checking utilities</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>in_types</strong> (<a class="reference internal" href="../check.html#chainer.utils.type_check.TypeInfoTuple" title="chainer.utils.type_check.TypeInfoTuple"><em>TypeInfoTuple</em></a>) – The type
information of input data for <a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.cpu_cosim_verify_result">
<code class="descname">cpu_cosim_verify_result</code><span class="sig-paren">(</span><em>mkl_result</em>, <em>numpy_result</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.cpu_cosim_verify_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.cpu_cosim_verify_result" title="Permalink to this definition">¶</a></dt>
<dd><p>cosim verify result between MKLDNN and numpy</p>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.delete_hook">
<code class="descname">delete_hook</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.delete_hook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.delete_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Unregisters the function hook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – the name of the function hook
to be unregistered.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>inputs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies forward propagation to input arrays.</p>
<p>It delegates the procedure to <a class="reference internal" href="#chainer.Function.forward_cpu" title="chainer.Function.forward_cpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_cpu()</span></code></a> or
<a class="reference internal" href="#chainer.Function.forward_gpu" title="chainer.Function.forward_gpu"><code class="xref py py-meth docutils literal"><span class="pre">forward_gpu()</span></code></a> by default. Which it selects is determined by the
type of input arrays.
Implementations of <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must implement either CPU/GPU
methods or this method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inputs</strong> – Tuple of input array(s).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Tuple of output array(s).</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementations of <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must take care that the
return value must be a tuple even if it returns only one array.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.forward_cpu">
<code class="descname">forward_cpu</code><span class="sig-paren">(</span><em>inputs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.forward_cpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.forward_cpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies forward propagation to input arrays on CPU.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inputs</strong> – Tuple of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> object(s).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Tuple of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> object(s).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)">tuple</a></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementations of <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must take care that the
return value must be a tuple even if it returns only one array.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.forward_gpu">
<code class="descname">forward_gpu</code><span class="sig-paren">(</span><em>inputs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.forward_gpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.forward_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies forward propagation to input arrays on GPU.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inputs</strong> – Tuple of <code class="xref py py-class docutils literal"><span class="pre">cupy.ndarray</span></code> object(s).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Tuple of <code class="xref py py-class docutils literal"><span class="pre">cupy.ndarray</span></code> object(s).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.6)">tuple</a></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementations of <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> must take care that the
return value must be a tuple even if it returns only one array.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="chainer.Function.label">
<code class="descname">label</code><a class="headerlink" href="#chainer.Function.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Short text that represents the function.</p>
<p>The default implementation returns its type name.
Each function should override it to give more information.</p>
</dd></dl>

<dl class="attribute">
<dt id="chainer.Function.local_function_hooks">
<code class="descname">local_function_hooks</code><a class="headerlink" href="#chainer.Function.local_function_hooks" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered Dictionary of registered function hooks.</p>
<p>Contrary to <code class="docutils literal"><span class="pre">chainer.thread_local.function_hooks</span></code>,
which registers its elements to all functions,
Function hooks in this property is specific to this function.</p>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.retain_inputs">
<code class="descname">retain_inputs</code><span class="sig-paren">(</span><em>indexes</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.retain_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.retain_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Lets specified input variable nodes keep data arrays.</p>
<p>By calling this method from <a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a>, the function can specify
which inputs are required for backprop.</p>
<p>If this method is not called, the function keeps all input arrays. If
you want to release all input arrays, call this method by passing an
empty sequence.</p>
<p>Note that <strong>this method must not be called from the outside of
forward method.</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>indexes</strong> (<em>iterable of int</em>) – Indexes of input variables that the
function does not require for backprop.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.retain_outputs">
<code class="descname">retain_outputs</code><span class="sig-paren">(</span><em>indexes</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.retain_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.retain_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Lets specified output variable nodes keep data arrays.</p>
<p>By calling this method from <a class="reference internal" href="#chainer.Function.forward" title="chainer.Function.forward"><code class="xref py py-meth docutils literal"><span class="pre">forward()</span></code></a>, the function can specify
which outputs are required for backprop. If this method is not called,
any output variables are not marked to keep the data array at the point
of returning from <code class="xref py py-meth docutils literal"><span class="pre">__call__()</span></code>. The retained arrays are stored to
<code class="xref py py-attr docutils literal"><span class="pre">output_data</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is STRONGLY RECOMMENDED to use this method if the function
requires some or all output arrays in backprop. The function can
also use output arrays just by keeping references to them directly,
whereas it might influence on the performance of later function
applications to the output variables.</p>
</div>
<p>Note that <strong>this method must not be called from the outside of
forward method.</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>indexes</strong> (<em>iterable of int</em>) – Indexes of input variables that the
function does not require for backprop.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chainer.Function.unchain">
<code class="descname">unchain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#Function.unchain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.Function.unchain" title="Permalink to this definition">¶</a></dt>
<dd><p>Purges in/out nodes and this function itself from the graph.</p>
<p>This method is called from <a class="reference internal" href="variable.html#chainer.Variable.unchain_backward" title="chainer.Variable.unchain_backward"><code class="xref py py-meth docutils literal"><span class="pre">Variable.unchain_backward()</span></code></a> method.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="chainer.force_backprop_mode">
<code class="descclassname">chainer.</code><code class="descname">force_backprop_mode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#force_backprop_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.force_backprop_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a context manager which enables back-propagation.</p>
<p>When you want to enable back-propagation in <a class="reference internal" href="#chainer.no_backprop_mode" title="chainer.no_backprop_mode"><code class="xref py py-func docutils literal"><span class="pre">no_backprop_mode()</span></code></a>,
call this method. :~chainer.Variable: created in this context always has
a computational graph.
If you call this method outside of <a class="reference internal" href="#chainer.no_backprop_mode" title="chainer.no_backprop_mode"><code class="xref py py-func docutils literal"><span class="pre">no_backprop_mode()</span></code></a> context, it
changes nothing.</p>
<p>In this example, <code class="docutils literal"><span class="pre">y</span></code> has a computational graph and <code class="docutils literal"><span class="pre">y.backward</span></code>
computes gradients of variables in the graph.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">chainer</span><span class="o">.</span><span class="n">no_backprop_mode</span><span class="p">():</span>
<span class="gp">... </span>  <span class="k">with</span> <span class="n">chainer</span><span class="o">.</span><span class="n">force_backprop_mode</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See <a class="reference internal" href="#chainer.no_backprop_mode" title="chainer.no_backprop_mode"><code class="xref py py-func docutils literal"><span class="pre">no_backprop_mode()</span></code></a> for details of back-prop mode.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="chainer.no_backprop_mode">
<code class="descclassname">chainer.</code><code class="descname">no_backprop_mode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/chainer/function.html#no_backprop_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chainer.no_backprop_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a context manager which disables back-propagation.</p>
<p>In this context, Chainer does not make a computational graph.
<a class="reference internal" href="variable.html#chainer.Variable" title="chainer.Variable"><code class="xref py py-class docutils literal"><span class="pre">Variable</span></code></a> created in this context does not have
reference to the <a class="reference internal" href="#chainer.Function" title="chainer.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> which created the variable.
So, you cannot compute gradient with <a class="reference internal" href="variable.html#chainer.Variable.backward" title="chainer.Variable.backward"><code class="xref py py-func docutils literal"><span class="pre">backward()</span></code></a>.
Instead memory consumption is reduced.</p>
<p>In this example, <code class="docutils literal"><span class="pre">y</span></code> is created in this context. So you cannot call
<code class="xref py py-func docutils literal"><span class="pre">backward()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">chainer</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,],</span> <span class="s1">&#39;f&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">chainer</span><span class="o">.</span><span class="n">no_backprop_mode</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="link.html" class="btn btn-neutral float-right" title="Link and Chain" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="flag.html" class="btn btn-neutral" title="Flag" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Preferred Networks, inc. and Preferred Infrastructure, inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.0.0b1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>